<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TEST ğŸ”¥</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

/* â”€â”€ THÃˆMES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
:root{
â€“bg:#070710;â€“bg2:#10102a;â€“bg3:#181835;
â€“border:rgba(255,255,255,0.08);
â€“pk:#ff2d78;â€“pu:#7c3aed;â€“cy:#06d6e0;
â€“go:#fbbf24;â€“gr:#10b981;â€“rd:#ef4444;â€“or:#f97316;
â€“tx:#f0efff;â€“mu:#8892a4;
color-scheme:dark
}
:root.light{
â€“bg:#f2f2fa;â€“bg2:#ffffff;â€“bg3:#e6e6f5;
â€“border:rgba(0,0,0,0.09);
â€“pk:#d81567;â€“pu:#5b21b6;â€“cy:#0369a1;
â€“go:#b45309;â€“gr:#047857;â€“rd:#b91c1c;â€“or:#c2410c;
â€“tx:#0d0d1f;â€“mu:#52525b;
color-scheme:light
}

html{background:var(â€“bg)!important;color:var(â€“tx)!important}
html,body{min-height:100vh;background:var(â€“bg)!important;color:var(â€“tx)!important;font-family:â€˜DM Sansâ€™,sans-serif;overflow-x:hidden}

/* â”€â”€ CANVAS BG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#bgc{position:fixed;inset:0;z-index:0;pointer-events:none;width:100vw!important;height:100vh!important}

/* â”€â”€ APP WRAPPER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.app{position:relative;z-index:1;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:16px 16px 60px}

/* â”€â”€ SCREENS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sc{display:none;width:100%;max-width:440px;flex-direction:column;align-items:center}
.sc.on{display:flex}

/* â”€â”€ TYPO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.huge{font-family:â€˜Bebas Neueâ€™,sans-serif;font-size:clamp(56px,16vw,96px);line-height:.88;letter-spacing:2px;background:linear-gradient(135deg,var(â€“pk),var(â€“pu) 55%,var(â€“cy));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-align:center}
.ttl{font-family:â€˜Bebas Neueâ€™,sans-serif;font-size:26px;letter-spacing:2px}
.lbl{font-size:10px;letter-spacing:3px;text-transform:uppercase;color:var(â€“mu);margin-bottom:6px;display:block}
.sm{font-size:13px}.xs{font-size:11px}.bold{font-weight:700}.mono{font-family:â€˜Space Monoâ€™,monospace}
.muted{color:var(â€“mu)}.gpk{color:var(â€“pk)}.gcy{color:var(â€“cy)}.ggo{color:var(â€“go)}.ggr{color:var(â€“gr)}
.tc{text-align:center}

/* â”€â”€ CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.card{background:var(â€“bg2);border:1px solid var(â€“border);border-radius:18px;padding:26px 22px;width:100%;position:relative;overflow:hidden}
.card::before{content:â€™â€™;position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent)}
:root.light .card::before{background:linear-gradient(90deg,transparent,rgba(0,0,0,0.05),transparent)}

/* â”€â”€ BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn{display:flex;align-items:center;justify-content:center;gap:8px;padding:15px 22px;border-radius:12px;border:none;font-family:â€˜DM Sansâ€™,sans-serif;font-weight:700;font-size:15px;cursor:pointer;transition:transform .15s,box-shadow .2s;width:100%;position:relative;overflow:hidden;letter-spacing:.3px}
.btn:active{transform:scale(.97)}
.btn:disabled{opacity:.4;cursor:not-allowed}
.bp{background:linear-gradient(135deg,var(â€“pk),var(â€“pu));color:#fff;box-shadow:0 4px 20px rgba(255,45,120,.3)}
.bp:hover{box-shadow:0 6px 30px rgba(255,45,120,.5)}
.bs{background:linear-gradient(135deg,var(â€“pu),var(â€“cy));color:#fff;box-shadow:0 4px 20px rgba(124,58,237,.3)}
.bg_{background:var(â€“bg3);color:var(â€“mu);border:1px solid var(â€“border)}
.bg_:hover{color:var(â€“tx)}
.bsm{padding:9px 16px;font-size:13px;border-radius:10px}

/* â”€â”€ INPUTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.inp{width:100%;padding:13px 15px;background:var(â€“bg3);border:1px solid var(â€“border);border-radius:12px;color:var(â€“tx);font-family:â€˜DM Sansâ€™,sans-serif;font-size:15px;outline:none;transition:border-color .2s,box-shadow .2s}
.inp:focus{border-color:var(â€“pk);box-shadow:0 0 0 3px rgba(255,45,120,.12)}
.inp::placeholder{color:var(â€“mu)}
.inp-code{text-align:center;font-family:â€˜Space Monoâ€™,monospace;font-size:30px;font-weight:700;letter-spacing:12px}
.ta{width:100%;min-height:88px;padding:13px 15px;background:var(â€“bg3);border:1px solid var(â€“border);border-radius:12px;color:var(â€“tx);font-family:â€˜DM Sansâ€™,sans-serif;font-size:15px;outline:none;resize:none;transition:border-color .2s;line-height:1.5}
.ta:focus{border-color:var(â€“pu);box-shadow:0 0 0 3px rgba(124,58,237,.12)}
.ta::placeholder{color:var(â€“mu)}
.sel{width:100%;padding:13px 15px;background:var(â€“bg3);border:1px solid var(â€“border);border-radius:12px;color:var(â€“tx);font-family:â€˜DM Sansâ€™,sans-serif;font-size:15px;outline:none;cursor:pointer;appearance:none;-webkit-appearance:none;background-image:url(â€œdata:image/svg+xml,%3Csvg xmlns=â€˜http://www.w3.org/2000/svgâ€™ width=â€˜12â€™ height=â€˜8â€™%3E%3Cpath d=â€˜M1 1l5 5 5-5â€™ stroke=â€™%238892a4â€™ stroke-width=â€˜1.5â€™ fill=â€˜noneâ€™ stroke-linecap=â€˜roundâ€™/%3E%3C/svg%3Eâ€);background-repeat:no-repeat;background-position:right 14px center}
.sel option{background:var(â€“bg2)}

/* â”€â”€ CAT GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.cat-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;width:100%}
.ctile{padding:14px 10px;border-radius:13px;border:1.5px solid var(â€“border);background:var(â€“bg3);cursor:pointer;text-align:center;transition:all .18s;user-select:none;position:relative;overflow:hidden}
.ctile *{pointer-events:none}
.ctile:hover{transform:translateY(-1px)}
.ctile.on{border-color:currentColor}
.ctile.on::after{content:â€˜âœ“â€™;position:absolute;top:6px;right:8px;font-size:11px;font-weight:bold;pointer-events:none}
.ctile .bi{font-size:24px;display:block;margin-bottom:3px}
.ctile .cn{font-size:12px;font-weight:700;display:block}
.ctile .ck{font-size:10px;font-family:â€˜Space Monoâ€™;opacity:.5}
.cc{color:#93c5fd}.cco{color:#f9a8d4}.cup{color:#c4b5fd}.ch{color:var(â€“or)}

/* â”€â”€ CODE BOX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.codebox{background:var(â€“bg3);border:1px solid var(â€“border);border-radius:15px;padding:18px 22px;text-align:center;position:relative;overflow:hidden}
.codebox::before{content:â€™â€™;position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,45,120,.04),transparent 60%);pointer-events:none}
.codenum{
font-family:â€˜Space Monoâ€™,â€˜Courier Newâ€™,Courier,monospace;
font-size:48px;
font-weight:700;
letter-spacing:10px;
color:#ffffff;
display:block;
line-height:1;
background:linear-gradient(135deg,#06d6e0,#ff2d78);
-webkit-background-clip:text;
background-clip:text;
-webkit-text-fill-color:transparent;
/* Fallback si le dÃ©gradÃ© ne marche pas */
text-shadow:none;
padding:4px 0;
}
/* Fallback absolu : si background-clip ne marche pas, texte visible quand mÃªme */
@supports not (-webkit-background-clip:text){
.codenum{color:var(â€“cy);-webkit-text-fill-color:var(â€“cy);}
}
:root.light .codenum{color:var(â€“pu)}
.copyhint{font-size:11px;color:var(â€“mu);cursor:pointer;margin-top:5px;transition:color .2s}
.copyhint:hover{color:var(â€“cy)}

/* â”€â”€ PLAYER ROW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.plist{display:flex;flex-direction:column;gap:7px;width:100%}
.prow{display:flex;align-items:center;gap:11px;padding:11px 14px;background:var(â€“bg3);border-radius:11px;border:1px solid var(â€“border);animation:slideIn .3s ease-out}
.prow.me{border-color:rgba(255,45,120,.3)}
.pav{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.pnm{font-weight:700;font-size:14px;flex:1}
.pbdg{font-size:10px;padding:3px 8px;border-radius:20px;font-family:â€˜Space Monoâ€™}
.bhost{background:rgba(251,191,36,.15);color:var(â€“go)}
.bread{background:rgba(16,185,129,.15);color:var(â€“gr)}
.bme{background:rgba(255,45,120,.15);color:var(â€“pk)}
.empty-slot{display:flex;align-items:center;gap:9px;padding:11px 14px;border:1px dashed rgba(255,255,255,.07);border-radius:11px;color:var(â€“mu);font-size:13px}
:root.light .empty-slot{border-color:rgba(0,0,0,.1)}

/* â”€â”€ GAME TOPBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.gtop{display:flex;justify-content:space-between;align-items:center;width:100%;max-width:520px;margin-bottom:14px;padding:0 2px}
.turninfo{text-align:center}
.turnlbl{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(â€“mu)}
.turnnm{font-family:â€˜Bebas Neueâ€™,sans-serif;font-size:22px;letter-spacing:1px;background:linear-gradient(135deg,var(â€“pk),var(â€“pu));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.rpill{font-family:â€˜Space Monoâ€™,monospace;font-size:11px;color:var(â€“mu);background:var(â€“bg2);border:1px solid var(â€“border);border-radius:20px;padding:5px 11px}

/* â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.pwrap{width:100%;max-width:520px;margin-bottom:18px}
.ptrack{height:3px;background:rgba(255,255,255,.05);border-radius:4px;overflow:hidden}
.pbar{height:100%;background:linear-gradient(90deg,var(â€“pk),var(â€“pu),var(â€“cy));border-radius:4px;transition:width .6s ease}
:root.light .ptrack{background:rgba(0,0,0,.08)}

/* â”€â”€ QUESTION CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.qcard{background:var(â€“bg2);border:1px solid var(â€“border);border-radius:20px;padding:26px 22px;width:100%;max-width:520px;position:relative;overflow:hidden;animation:cardPop .42s cubic-bezier(.34,1.56,.64,1)}
.qcard::before{content:â€™â€™;position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);pointer-events:none}
:root.light .qcard::before{background:linear-gradient(90deg,transparent,rgba(0,0,0,.04),transparent)}
.qcard.ta_{border-top:3px solid var(â€“or)}
.qcard.tv{border-top:3px solid var(â€“cy)}
.qcard.hot{box-shadow:0 0 50px rgba(255,45,120,.12)}

.qtag{display:inline-flex;align-items:center;gap:5px;padding:5px 11px;border-radius:20px;font-size:11px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:16px}
.tga{background:rgba(249,115,22,.12);color:var(â€“or);border:1px solid rgba(249,115,22,.25)}
.tgv{background:rgba(6,214,224,.12);color:var(â€“cy);border:1px solid rgba(6,214,224,.25)}
.catc{float:right;font-size:9px;letter-spacing:1.5px;text-transform:uppercase;color:var(â€“mu);background:var(â€“bg3);border:1px solid var(â€“border);border-radius:6px;padding:3px 7px}
.qtxt{font-family:â€˜DM Sansâ€™,sans-serif;font-weight:700;font-size:clamp(17px,4.5vw,22px);line-height:1.45;margin-bottom:22px;min-height:56px;clear:both}

/* â”€â”€ CHOOSE GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.cgrid{display:grid;grid-template-columns:1fr 1fr;gap:11px;margin-top:4px}
.bact{background:rgba(249,115,22,.1);border:1.5px solid rgba(249,115,22,.4);color:var(â€“or);font-size:16px;padding:20px 14px;border-radius:15px;flex-direction:column;gap:3px;transition:all .2s}
.bact:hover{background:rgba(249,115,22,.18);box-shadow:0 8px 28px rgba(249,115,22,.2);transform:translateY(-2px)}
.bvrt{background:rgba(6,214,224,.1);border:1.5px solid rgba(6,214,224,.4);color:var(â€“cy);font-size:16px;padding:20px 14px;border-radius:15px;flex-direction:column;gap:3px;transition:all .2s}
.bvrt:hover{background:rgba(6,214,224,.18);box-shadow:0 8px 28px rgba(6,214,224,.2);transform:translateY(-2px)}
.cico{font-size:28px}.clbl{font-family:â€˜Bebas Neueâ€™;font-size:20px;letter-spacing:1px}.csub{font-size:10px;font-family:â€˜Space Monoâ€™;opacity:.6;font-weight:400}

/* â”€â”€ DOTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dots{display:flex;gap:6px;justify-content:center;margin:10px 0}
.dot{width:9px;height:9px;border-radius:50%;animation:dotB 1.2s ease-in-out infinite}
.dot:nth-child(1){background:var(â€“pk)}.dot:nth-child(2){background:var(â€“pu);animation-delay:.15s}.dot:nth-child(3){background:var(â€“cy);animation-delay:.3s}

/* â”€â”€ REVEAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.rwrap{width:100%;max-width:520px}
.rans{background:var(â€“bg2);border:1px solid var(â€“border);border-radius:13px;padding:15px 16px;margin-bottom:9px;border-left:3px solid var(â€“pk);animation:slideIn .3s ease-out}
.rwho{font-size:12px;font-weight:700;margin-bottom:5px;display:flex;align-items:center;gap:6px}
.rtxt{font-size:15px;line-height:1.5}
.remp{color:var(â€“mu);font-style:italic;font-size:13px}

/* â”€â”€ END â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.podrow{display:flex;align-items:center;gap:11px;padding:13px 16px;background:var(â€“bg2);border-radius:13px;border:1px solid var(â€“border)}
.podrank{font-family:â€˜Bebas Neueâ€™;font-size:24px;width:28px;text-align:center}

/* â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#toast{position:fixed;bottom:22px;left:50%;transform:translateX(-50%) translateY(120px);background:var(â€“bg2);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px 20px;font-weight:700;font-size:14px;z-index:9999;transition:transform .35s cubic-bezier(.34,1.56,.64,1);white-space:nowrap;max-width:90vw;text-align:center;pointer-events:none;color:var(â€“tx)}
#toast.up{transform:translateX(-50%) translateY(0)}
#toast.ok{border-color:var(â€“gr)}#toast.er{border-color:var(â€“rd)}#toast.if{border-color:var(â€“pu)}

/* â”€â”€ TOP BUTTONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.topbtn{position:fixed;z-index:300;background:var(â€“bg2);border:1px solid var(â€“border);border-radius:50px;padding:7px 14px;font-size:13px;font-weight:700;cursor:pointer;font-family:â€˜DM Sansâ€™,sans-serif;color:var(â€“mu);display:none;align-items:center;gap:5px;transition:all .2s;box-shadow:0 2px 12px rgba(0,0,0,.15)}
.topbtn:hover{color:var(â€“tx);border-color:var(â€“pk)}
.topbtn.vis{display:flex}
#back-btn{top:14px;left:14px}
#theme-btn{top:14px;right:14px;display:flex}

/* â”€â”€ SPINNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.spin{width:42px;height:42px;border:3px solid rgba(255,255,255,.07);border-top-color:var(â€“pk);border-radius:50%;animation:rot .8s linear infinite}
:root.light .spin{border-color:rgba(0,0,0,.1);border-top-color:var(â€“pk)}

/* â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.col{display:flex;flex-direction:column;gap:11px;width:100%}
.row{display:flex;gap:10px;align-items:center}
.sep{width:100%;height:1px;background:var(â€“border);margin:14px 0}
.w100{width:100%}
.mt4{margin-top:4px}.mt8{margin-top:8px}.mt12{margin-top:12px}.mt16{margin-top:16px}.mt20{margin-top:20px}.mt24{margin-top:24px}
.mb8{margin-bottom:8px}.mb12{margin-bottom:12px}.mb16{margin-bottom:16px}.mb20{margin-bottom:20px}

/* â”€â”€ ANIMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@keyframes cardPop{from{opacity:0;transform:scale(.87) translateY(14px)}to{opacity:1;transform:scale(1) translateY(0)}}
@keyframes slideIn{from{opacity:0;transform:translateY(9px)}to{opacity:1;transform:translateY(0)}}
@keyframes dotB{0%,80%,100%{transform:scale(1);opacity:.4}40%{transform:scale(1.5);opacity:1}}
@keyframes rot{to{transform:rotate(360deg)}}
@keyframes confY{to{transform:translateY(110vh) rotate(720deg);opacity:0}}
.shk{animation:shk .35s ease}
@keyframes shk{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-5px)}80%{transform:translateX(4px)}}

@media(max-width:380px){.qtxt{font-size:16px}.card,.qcard{padding:20px 16px}}
</style>

</head>
<body>

<canvas id="bgc"></canvas>

<button class="topbtn" id="back-btn">â† Quitter</button>
<button class="topbtn" id="theme-btn">
<span id="ticon">ğŸŒ™</span><span id="tlbl">Sombre</span>
</button>

<div id="toast"></div>

<div class="app">

  <!-- HOME -->

  <div id="s-home" class="sc on">
    <div class="mb20" style="animation:cardPop .5s ease-out">
      <div style="text-align:center;font-size:11px;letter-spacing:4px;color:var(--pk);margin-bottom:8px;text-transform:uppercase">ğŸ”¥ Le jeu de soirÃ©e</div>
      <div class="huge">TEST</div>
      <div style="font-family:'Bebas Neue';font-size:20px;letter-spacing:3px;text-align:center;color:var(--mu);margin-top:4px">Action ou VÃ©ritÃ©</div>
    </div>
    <div style="display:flex;gap:7px;flex-wrap:wrap;justify-content:center;margin-bottom:26px">
      <span style="padding:4px 11px;border-radius:20px;background:rgba(249,115,22,.1);color:var(--or);font-size:11px;border:1px solid rgba(249,115,22,.2)">ğŸ’ª Action</span>
      <span style="padding:4px 11px;border-radius:20px;background:rgba(6,214,224,.1);color:var(--cy);font-size:11px;border:1px solid rgba(6,214,224,.2)">ğŸ’¬ VÃ©ritÃ©</span>
      <span style="padding:4px 11px;border-radius:20px;background:rgba(255,45,120,.1);color:var(--pk);font-size:11px;border:1px solid rgba(255,45,120,.2)">ğŸ”¥ Hot</span>
    </div>
    <div class="col" style="max-width:360px">
      <button class="btn bp" id="btn-go-create">ğŸ¯ CrÃ©er une partie</button>
      <button class="btn bs" id="btn-go-join">ğŸšª Rejoindre une partie</button>
    </div>
    <div class="mt16 xs muted tc">Multijoueur en ligne â€¢ 2â€“8 joueurs â€¢ 500+ questions</div>
  </div>

  <!-- CREATE -->

  <div id="s-create" class="sc">
    <div class="card w100" style="max-width:420px">
      <div class="ttl gpk mb16">CrÃ©er une partie ğŸ¯</div>
      <div class="col">
        <div>
          <span class="lbl">Ton prÃ©nom</span>
          <input class="inp" id="c-name" type="text" placeholder="Ex: Sophie" maxlength="16" autocomplete="off">
        </div>
        <div>
          <span class="lbl">Nombre de rounds</span>
          <select class="sel" id="c-rounds">
            <option value="10">10 rounds â€” rapide ğŸƒ</option>
            <option value="20" selected>20 rounds â€” normal âš¡</option>
            <option value="30">30 rounds â€” long ğŸª</option>
            <option value="50">50 rounds â€” marathon ğŸŸï¸</option>
          </select>
        </div>
        <div>
          <span class="lbl">CatÃ©gories</span>
          <div class="cat-grid">
            <div class="ctile cc on" data-cat="classique"><span class="bi">ğŸ˜‚</span><span class="cn">Classique</span><span class="ck">140 questions</span></div>
            <div class="ctile cco on" data-cat="coquin"><span class="bi">ğŸ˜</span><span class="cn">Coquin</span><span class="ck">120 questions</span></div>
            <div class="ctile cup" data-cat="couple"><span class="bi">ğŸ’‘</span><span class="cn">Couple</span><span class="ck">110 questions</span></div>
            <div class="ctile ch" data-cat="hot"><span class="bi">ğŸ”¥</span><span class="cn">Hot 18+</span><span class="ck">130 questions</span></div>
          </div>
        </div>
        <button class="btn bp" id="btn-create">CrÃ©er la partie âœ¨</button>
        <button class="btn bg_ bsm" id="btn-create-back">â† Retour</button>
      </div>
    </div>
  </div>

  <!-- JOIN -->

  <div id="s-join" class="sc">
    <div class="card w100" style="max-width:380px">
      <div class="ttl gcy mb16">Rejoindre ğŸšª</div>
      <div class="col">
        <div>
          <span class="lbl">Ton prÃ©nom</span>
          <input class="inp" id="j-name" type="text" placeholder="Ex: Alex" maxlength="16" autocomplete="off">
        </div>
        <div>
          <span class="lbl">Code de la partie</span>
          <input class="inp inp-code" id="j-code" type="text" placeholder="XXXX" maxlength="4">
        </div>
        <button class="btn bs" id="btn-join">Rejoindre ğŸš€</button>
        <button class="btn bg_ bsm" id="btn-join-back">â† Retour</button>
      </div>
    </div>
  </div>

  <!-- LOBBY -->

  <div id="s-lobby" class="sc">
    <div class="card w100 mb12" style="max-width:440px">
      <div class="tc mb12">
        <div class="ttl">Salle d'attente ğŸ®</div>
        <div class="sm muted mt4">Partage le code Ã  tes amis</div>
      </div>
      <div class="codebox mb14">
        <span class="codenum" id="l-code" style="display:block;font-family:'Space Mono','Courier New',monospace;font-size:48px;font-weight:700;letter-spacing:10px;color:#06d6e0;text-align:center;padding:8px 0">----</span>
        <div class="copyhint" id="btn-copy">ğŸ“‹ Toucher pour copier</div>
      </div>
      <div class="plist" id="l-players"></div>
      <div class="sep"></div>
      <div id="l-settings" class="xs muted tc mb10" style="line-height:1.9"></div>
      <div id="l-status" class="tc sm muted mb10"></div>
      <button class="btn bp w100" id="l-start" style="display:none">ğŸš€ Lancer la partie!</button>
      <div id="l-hint" class="tc xs muted mt8" style="display:none"></div>
    </div>
  </div>

  <!-- GAME -->

  <div id="s-game" class="sc" style="align-items:center">
    <div class="gtop">
      <div class="turninfo"><div class="turnlbl">Au tour de</div><div class="turnnm" id="g-turn">â€”</div></div>
      <div id="g-round" class="rpill">Round 1/20</div>
    </div>
    <div class="pwrap"><div class="ptrack"><div class="pbar" id="g-prog" style="width:0%"></div></div></div>

```
<!-- Phase: Choisir -->
<div id="ph-choose" class="qcard" style="display:none;max-width:520px">
  <div class="tc" style="padding:6px 0 18px">
    <div style="font-size:42px;margin-bottom:10px">ğŸ²</div>
    <div id="ch-who" style="font-family:'Bebas Neue';font-size:22px;letter-spacing:1px;color:var(--pk)">C'EST TON TOUR!</div>
    <div class="sm muted mt4 mb18">Choisis ta destinÃ©e...</div>
    <div class="cgrid" id="ch-btns">
      <button class="btn bact" id="btn-action">
        <span class="cico">ğŸ’ª</span><span class="clbl">ACTION</span><span class="csub">Ose le faire</span>
      </button>
      <button class="btn bvrt" id="btn-verite">
        <span class="cico">ğŸ’¬</span><span class="clbl">VÃ‰RITÃ‰</span><span class="csub">Dis tout</span>
      </button>
    </div>
    <div id="ch-wait" style="display:none">
      <div class="sm muted">En attente du choix...</div>
      <div class="dots mt8"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
    </div>
  </div>
</div>

<!-- Phase: RÃ©pondre -->
<div id="ph-ans" class="qcard" style="display:none;max-width:520px">
  <div class="catc" id="a-cat">â€”</div>
  <div class="qtag" id="a-tag">â€”</div>
  <div class="qtxt" id="a-q">â€”</div>
  <div id="a-mine">
    <textarea class="ta" id="a-inp" placeholder="Tape ta rÃ©ponse... (ou dÃ©cris ce que tu vas faire)"></textarea>
    <button class="btn bp mt8" id="btn-submit">Envoyer âœ…</button>
  </div>
  <div id="a-wait" style="display:none">
    <div class="sm muted tc" id="a-waittxt">En attente des autres...</div>
    <div class="dots mt8"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
  </div>
</div>

<!-- Phase: RÃ©vÃ©lation -->
<div id="ph-rev" class="rwrap" style="display:none">
  <div class="tc mb14">
    <div style="font-size:34px">ğŸ“–</div>
    <div style="font-family:'Bebas Neue';font-size:30px;letter-spacing:2px;color:var(--go)">RÃ©vÃ©lation!</div>
    <div class="xs muted mt4" id="r-recap" style="font-style:italic;padding:0 6px"></div>
  </div>
  <div id="r-cards"></div>
  <button class="btn bp mt14 w100" id="r-next" style="display:none">Prochaine question â†’</button>
  <div class="tc xs muted mt8" id="r-wait" style="display:none">L'hÃ´te passe Ã  la suite...</div>
</div>
```

  </div>

  <!-- END -->

  <div id="s-end" class="sc">
    <div style="font-size:70px;text-align:center;margin-bottom:8px">ğŸ†</div>
    <div class="huge" style="font-size:54px;margin-bottom:4px">GG!</div>
    <div class="muted tc mb20" id="e-sub">Partie terminÃ©e!</div>
    <div class="col w100 mb22" id="e-pod"></div>
    <div class="row" style="flex-wrap:wrap;justify-content:center;gap:10px">
      <button class="btn bp" id="btn-replay" style="width:auto;padding:13px 26px">ğŸ”„ Rejouer</button>
      <button class="btn bg_" id="btn-home-end" style="width:auto;padding:13px 26px">ğŸ  Accueil</button>
    </div>
  </div>

</div><!-- /app -->

<!-- Firebase â€” chargÃ© en arriÃ¨re-plan, invisible -->

<script>
// Charge Firebase de faÃ§on silencieuse
(function(){
  var s1=document.createElement('script');
  s1.src='https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js';
  s1.async=true;
  var s2=document.createElement('script');
  s2.src='https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js';
  s2.async=true;
  s1.onload=function(){
    document.head.appendChild(s2);
    s2.onload=initFB;
  };
  document.head.appendChild(s1);
})();

var db=null,fbReady=false;

function initFB(){
  try{
    var cfg={
      apiKey:"AIzaSyAWW-rnF1dqdCc5kCuI-d9dTSMrBJCrSb0",
      authDomain:"test-a5848.firebaseapp.com",
      databaseURL:"https://test-a5848-default-rtdb.europe-west1.firebasedatabase.app",
      projectId:"test-a5848",
      storageBucket:"test-a5848.firebasestorage.app",
      messagingSenderId:"704331097703",
      appId:"1:704331097703:web:664a8e24613d38ed2316c2"
    };
    if(!firebase.apps.length) firebase.initializeApp(cfg);
    db=firebase.database();
    fbReady=true;
  }catch(e){
    console.warn('FB init error',e);
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// 500+ QUESTIONS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var Q={
classique:{
action:[
"Fais 15 pompes devant tout le monde maintenant.",
"Imite la personne de ton choix pendant 1 minute. Les autres devinent qui.",
"Chante le refrain d'une chanson Ã  tue-tÃªte.",
"Envoie un message bizarre au dernier contact de tes SMS.",
"Fais une danse ridicule pendant 30 secondes sans t'arrÃªter.",
"Mange une cuillÃ¨re de sauce piquante sans grimace.",
"Imite un animal pendant 2 min â€” les autres devinent lequel.",
"Fais le tour de la piÃ¨ce Ã  quatre pattes en aboyant.",
"Parle avec un accent exagÃ©rÃ© pour les 3 prochains rounds.",
"Fais semblant d'Ãªtre un robot pendant 2 minutes complÃ¨tes.",
"Bois un verre d'eau sans utiliser tes mains.",
"Reste sur une seule jambe pendant tout le prochain round.",
"Appelle un parent et dis-lui que tu es Ã©perdument amoureux d'un inconnu.",
"Fais la planche le plus longtemps possible.",
"Fais une photo la plus embarrassante possible et garde-la 5 min en story.",
"Chante 'Joyeux Anniversaire' Ã  voix haute dans un message vocal Ã  quelqu'un.",
"Parle uniquement en chuchotant pendant 5 minutes complÃ¨tes.",
"Fais une roue â€” ou essaie pendant 30 secondes.",
"Dis un compliment sincÃ¨re et dÃ©taillÃ© Ã  chaque joueur.",
"LÃ¨che ton coude pendant 10 secondes (c'est presque impossible!).",
"Fais semblant de faire un discours de mariage pour la personne Ã  ta gauche.",
"Mange quelque chose bizarre du frigo sans regarder ce que c'est.",
"Fais le moonwalk de Michael Jackson Ã  travers la piÃ¨ce.",
"Mets tes vÃªtements Ã  l'envers pour le reste de la partie.",
"Crie 'Je vous aime!' par la fenÃªtre ou dans le couloir.",
"Fais 20 sauts Ã©toile en comptant Ã  voix haute.",
"Imite ton acteur/actrice prÃ©fÃ©rÃ©(e) pendant 1 minute.",
"Dessine un portrait de la personne Ã  ta droite en 60 secondes.",
"Envoie un GIF romantique Ã  la derniÃ¨re personne de tes contacts WhatsApp.",
"Fais une push-up avec quelqu'un assis sur ton dos.",
"Chante uniquement en opÃ©ra pendant les 5 prochaines minutes.",
"Invente et raconte une histoire de 1 minute avec les objets devant toi.",
"Fais semblant d'Ãªtre un mannequin sur un podium de dÃ©filÃ© pendant 30s.",
"Fais le plus beau sourire possible et tiens-le 20 secondes.",
"Dis le plus de nombres entre 1 et 100 en 20 secondes.",
],
verite:[
"Quelle est la chose la plus stupide que tu aies jamais faite?",
"Quel est le mensonge que tu rÃ©pÃ¨tes le plus souvent dans ta vie?",
"Quelle est ta pire peur secrÃ¨te que tu n'avoues jamais?",
"Qui appellerais-tu en premier lors d'une urgence grave?",
"Quel est le truc le plus inutile que tu aies achetÃ©?",
"Quelle mauvaise habitude as-tu mais n'assumes jamais en public?",
"Si tu pouvais effacer une pÃ©riode de ta vie, laquelle ce serait?",
"Quelle est la chose la plus bizarre que tu manges en secret?",
"Quel est ton pire souvenir de scolaritÃ©?",
"Quelle cÃ©lÃ©britÃ© tu dÃ©testes mais suis quand mÃªme sur les rÃ©seaux?",
"Quel mensonge as-tu dit Ã  tes parents et ils y ont totalement cru?",
"DÃ©cris ton crush de collÃ¨ge sans donner son nom.",
"Quelle est la chose la plus creepy que tu aies faite par curiositÃ©?",
"Quelle chanson tu Ã©coutes en boucle mais n'assumes jamais?",
"Quel film honte tu adores mais ne recommandes jamais?",
"Quelle chose enfantine fais-tu encore aujourd'hui?",
"Quelle est ta recherche Google la plus honteuse cette semaine?",
"Quelle peur irrationnelle as-tu encore aujourd'hui?",
"Si tu pouvais lire les pensÃ©es d'une personne ici, qui choisirais-tu?",
"Quel est le pire conseil que tu aies jamais donnÃ©?",
"Combien de fois vÃ©rifies-tu vraiment tes rÃ©seaux sociaux par jour?",
"Quelle est ta superstition secrÃ¨te?",
"As-tu dÃ©jÃ  menti sur ton CV? Sur quoi?",
"Quelle est la chose la plus chÃ¨re que tu aies perdue ou cassÃ©e?",
"De quoi es-tu le plus jaloux(se) chez quelqu'un dans cette piÃ¨ce?",
"Quel est ton plus grand regret de l'annÃ©e passÃ©e?",
"Si tu Ã©tais invisible 24h, que ferais-tu en premier?",
"Quel est le pire truc que tu aies fait Ã  un ex?",
"Quelle est la chose dont tu t'es vantÃ³(e) mais que tu n'avais pas vraiment faite?",
"Si ta vie Ã©tait un film, quel genre serait-il?",
"As-tu dÃ©jÃ  pris quelque chose qui ne t'appartenait pas? Quoi?",
"Quel est le truc le plus nul que tu aies fait pour impressionner quelqu'un?",
"Quelle Ã©motion caches-tu le mieux aux autres?",
"Si tu devais choisir une seule personne ici pour un road trip, qui?",
"As-tu dÃ©jÃ  espionnÃ© quelqu'un? Dans quel but?",
"Quelle est la promesse que tu n'as jamais tenue?",
"Quel est le secret que tu gardes depuis le plus longtemps?",
"Quelle est la chose la plus irresponsable que tu aies faite?",
"As-tu dÃ©jÃ  pleurÃ© devant un film ou une sÃ©rie? Lequel?",
"Si tu n'avais peur de rien, que ferais-tu dÃ¨s demain?",
],
},
coquin:{
action:[
"Fais un massage des Ã©paules Ã  la personne de ton choix pendant 1 minute.",
"Dis Ã  chaque joueur ce qui te plaÃ®t physiquement chez lui/elle.",
"Fais un catwalk ultra sÃ©ducteur Ã  travers la piÃ¨ce.",
"Siffle la personne de ton choix comme si elle passait dans la rue.",
"Pose ta main sur le genou de quelqu'un pendant 30s sans rire.",
"Ã‰cris un mot sur le dos de quelqu'un avec ton doigt â€” il doit deviner.",
"Fais ton regard le plus sÃ©ducteur Ã  la personne en face.",
"Chuchote quelque chose de mystÃ©rieux Ã  l'oreille de quelqu'un.",
"Mime une scÃ¨ne romantique de film sans un seul mot.",
"Lis un passage de roman Ã  l'eau de rose avec une intonation dramatique.",
"Fais la liste de tes 3 crush secrets (sans noms) Ã  voix haute.",
"DÃ©cris ton type idÃ©al en dÃ©tail â€” les autres devinent si c'est quelqu'un ici.",
"Donne un surnom flatteur Ã  chaque joueur et justifie-le.",
"Fais semblant de sÃ©duire une chaise pendant 20 secondes.",
"Chante une chanson romantique Ã  la personne de ton choix.",
"Ã‰cris un texto de drague pour la personne Ã  ta gauche â€” lis-le Ã  voix haute.",
"Fais le regard le plus Â« ne rÃ©siste pas Â» que tu connaisses.",
"DÃ©cris ta tenue de rÃªve pour une soirÃ©e romantique.",
"Fais un calin Ã  la personne de ton choix pendant 10 secondes.",
"Cligne des yeux langoureusement Ã  chaque joueur tour Ã  tour.",
"Mime embrasser quelqu'un avec passion pendant 5 secondes.",
"Complimente chaque joueur sur quelque chose que tu n'as jamais dit.",
"Dis Ã  voix haute le type de personne qui te rend complÃ¨tement fou/folle.",
"Fais semblant d'Ãªtre un(e) mannequin dans un clip romantique.",
"Raconte ton meilleur souvenir romantique en 30 secondes.",
],
verite:[
"Quel est ton plus grand fantasme que tu n'as jamais osÃ© avouer?",
"Ã€ quelle cÃ©lÃ©britÃ© as-tu dÃ©jÃ  pensÃ© de faÃ§on romantique?",
"Quelle est la chose la plus sÃ©duisante qu'on t'ait jamais dite?",
"As-tu dÃ©jÃ  embrassÃ© quelqu'un dans une soirÃ©e et regrettÃ© le lendemain?",
"Quelle est la premiÃ¨re chose que tu remarques chez quelqu'un qui t'attire?",
"As-tu dÃ©jÃ  envoyÃ© un message flirt au mauvais destinataire?",
"Quelle est ta meilleure ou pire expÃ©rience de baiser?",
"As-tu dÃ©jÃ  eu le bÃ©guin pour un(e) ami(e) de quelqu'un ici?",
"Quelle est la chose la plus audacieuse que tu aies faite pour plaire Ã  quelqu'un?",
"As-tu dÃ©jÃ  stalkÃ© l'ex d'un(e) ex sur les rÃ©seaux?",
"Quelle est la dÃ©claration la plus cringe qu'on t'ait faite?",
"As-tu dÃ©jÃ  embrassÃ© quelqu'un juste parce que tu t'ennuyais?",
"Quelle est la chose la plus risquÃ©e que tu aies faite par attirance?",
"As-tu dÃ©jÃ  jouÃ© l'indiffÃ©rent(e) alors que tu Ã©tais totalement accro?",
"Quel est le lieu le plus original oÃ¹ tu as embrassÃ© quelqu'un?",
"As-tu dÃ©jÃ  eu des sentiments pour ton/ta meilleur(e) ami(e)?",
"Quelle phrase de drague a marchÃ© sur toi contre toute attente?",
"Dans cette partie, qui inviterais-tu en date si tout le monde Ã©tait cÃ©libataire?",
"As-tu dÃ©jÃ  fait semblant d'aimer quelque chose pour impressionner un crush?",
"DÃ©cris ton type idÃ©al en 3 qualitÃ©s physiques et 3 qualitÃ©s de caractÃ¨re.",
"As-tu dÃ©jÃ  Ã©tÃ© jaloux(se) de faÃ§on totalement irrationnelle? Raconte.",
"Quel est le plus long temps sans embrasser quelqu'un que tu aies connu?",
"As-tu dÃ©jÃ  flirtÃ© sans le vouloir vraiment? Avec qui?",
"Quel est ton endroit romantique de rÃªve pour un premier rendez-vous?",
"As-tu dÃ©jÃ  menti sur ton statut amoureux pour Ã©viter quelqu'un?",
"Quel est le message le plus embarrassant que tu aies envoyÃ©?",
"As-tu dÃ©jÃ  eu un crush sur quelqu'un bien plus vieux/jeune que toi?",
"Quelle est la chose qui t'attire chez quelqu'un que tu n'assumes pas?",
"Comment rÃ©agis-tu quand quelqu'un te drague?",
"As-tu dÃ©jÃ  fait semblant de ne pas voir quelqu'un pour l'Ã©viter?",
"Quelle est ta faÃ§on prÃ©fÃ©rÃ©e de flirter?",
"DÃ©cris le baiser parfait selon toi.",
"As-tu dÃ©jÃ  embrassÃ© quelqu'un sur un coup de tÃªte? Comment c'Ã©tait?",
"Quel est le truc le plus romantique qu'on t'ait jamais fait?",
"Quelle est la chanson qui te met toujours dans l'ambiance romantique?",
],
},
couple:{
action:[
"Dis Ã  ton/ta partenaire 3 choses que tu adores chez lui/elle devant tout le monde.",
"Fais un cÃ¢lin Ã  ton/ta partenaire pendant 60 secondes sans bouger.",
"Raconte votre premiÃ¨re rencontre avec le maximum de dÃ©tails.",
"Dessine le visage de ton/ta partenaire de mÃ©moire en 30 secondes.",
"Chante une chanson qui reprÃ©sente votre relation.",
"Fais une photo couple maintenant, la plus belle possible.",
"Danse un slow avec ton/ta partenaire sans musique.",
"Dis Ã  ton/ta partenaire quel est ton moment prÃ©fÃ©rÃ© ensemble.",
"Ã‰cris 'Je t'aime' sur la main de ton/ta partenaire avec ton doigt.",
"DÃ©cris ton/ta partenaire en 3 super-pouvoirs qu'il/elle possÃ¨de.",
"Imite comment ton/ta partenaire rÃ©agit quand il/elle est de mauvaise humeur.",
"Fais semblant d'Ãªtre ton/ta partenaire pendant 1 minute.",
"RÃ©cite les paroles d'une chanson d'amour Ã  ton/ta partenaire.",
"Fais la liste des 5 raisons pour lesquelles tu l'aimes.",
"Prends la main de ton/ta partenaire et ne la lÃ¢che pas pendant le prochain round.",
"Dis Ã  voix haute ce que ton/ta partenaire fait qui te fait encore sourire.",
"Fais une promesse sincÃ¨re Ã  ton/ta partenaire devant tout le monde.",
"Ferme les yeux et dis 3 dÃ©tails physiques de ton/ta partenaire de mÃ©moire.",
],
verite:[
"Quel dÃ©faut de ton/ta partenaire as-tu mis le plus de temps Ã  accepter?",
"Quel est le souvenir que tu chÃ©ris le plus dans votre relation?",
"Y a-t-il quelque chose que tu n'as jamais osÃ© dire Ã  ton/ta partenaire?",
"Quelle est la dispute la plus ridicule que vous ayez jamais eue?",
"Qu'est-ce qui t'a fait rÃ©aliser que tu Ã©tais vraiment amoureux(se)?",
"Si tu devais dÃ©crire votre relation avec un film, lequel?",
"As-tu dÃ©jÃ  doutÃ© de votre relation? Dans quel contexte?",
"Quelle chose fait ton/ta partenaire que tu n'exprimes pas assez aimer?",
"Si vous deviez voyager ensemble, quelle serait votre destination de rÃªve?",
"Quel est le sacrifice le plus grand que tu aies fait pour ton/ta partenaire?",
"Comment imagines-tu votre vie dans 10 ans ensemble?",
"Quelle est la chose la plus folle que tu ferais pour cette relation?",
"Qu'est-ce que ton/ta partenaire fait qui te fait encore sourire aprÃ¨s tout ce temps?",
"As-tu dÃ©jÃ  Ã©tÃ© jaloux(se) sans raison valable? De qui?",
"Si tu pouvais changer une chose dans votre relation, laquelle?",
"Quelle qualitÃ© de ton/ta partenaire voudrais-tu avoir toi-mÃªme?",
"Quel est le moment oÃ¹ tu as Ã©tÃ© le plus fier(fiÃ¨re) de ton/ta partenaire?",
"As-tu dÃ©jÃ  eu peur de perdre ton/ta partenaire? Pourquoi?",
"Quel truc innocent ton/ta partenaire fait et qui te rend dingue (en bien)?",
"Si tu devais dÃ©crire ton amour en une seule chanson, laquelle?",
"Quel est le cadeau le plus significatif que vous vous soyez offert?",
"Comment gÃ¨res-tu les dÃ©saccords avec ton/ta partenaire?",
"Quelle est la premiÃ¨re chose que tu as remarquÃ©e chez ton/ta partenaire?",
"Qu'est-ce que ton/ta partenaire t'a appris sur toi-mÃªme?",
"Quel est le truc que tu fais uniquement grÃ¢ce Ã  lui/elle?",
"Si ton/ta partenaire partait 1 mois, qu'est-ce qui te manquerait le plus?",
"Quelle est la chose que tu n'avais jamais faite avant lui/elle?",
"Si tu devais recommencer votre histoire, changerais-tu quelque chose?",
"Qu'est-ce que tu aurais voulu savoir sur ton/ta partenaire dÃ¨s le dÃ©but?",
"Quelle est ta faÃ§on prÃ©fÃ©rÃ©e de passer du temps avec lui/elle?",
],
},
hot:{
action:[
"DÃ©cris en dÃ©tail ta tenue de rÃªve pour une soirÃ©e trÃ¨s intime.",
"Montre les derniers emojis que tu as envoyÃ©s et explique le contexte.",
"Lis tes 3 derniers messages envoyÃ©s Ã  voix haute sans les relire avant.",
"Fais la liste de tes 3 fantasmes les plus fous Ã  voix haute.",
"Dis Ã  voix haute ce que tu ferais si vous Ã©tiez seuls ce soir.",
"Envoie un message trÃ¨s flatteur et suggestif Ã  ton/ta partenaire maintenant.",
"DÃ©cris ton expÃ©rience la plus mÃ©morable en 30 secondes.",
"Dis Ã  chaque joueur ce que tu trouves sensuellement attirant chez lui/elle.",
"Lis un extrait d'un livre ou film romantique avec ta meilleure voix sÃ©ductrice.",
"DÃ©cris en 3 mots ce que tu attends d'une nuit parfaite.",
"Montre une photo de ton crush actuel ou passÃ© sans expliquer qui c'est.",
"Fais la liste des 5 choses qui t'attirent immÃ©diatement chez quelqu'un.",
"DÃ©cris le slow le plus torride que tu aies jamais dansÃ©.",
"Fais une dÃ©claration passionnÃ©e Ã  la personne de ton choix.",
],
verite:[
"Quelle est ta position prÃ©fÃ©rÃ©e? Tu sais de quoi on parle ğŸ˜",
"OÃ¹ est l'endroit le plus insolite oÃ¹ tu as vÃ©cu quelque chose d'intime?",
"Quelle est ta limite absolue dans une relation intime?",
"As-tu dÃ©jÃ  eu un rÃªve Ã©rotique impliquant quelqu'un d'inattendu?",
"Combien de partenaires romantiques as-tu eu? Sois honnÃªte.",
"Quelle est la chose la plus osÃ©e que tu aies faite avec un(e) partenaire?",
"Qu'est-ce qui te met le plus dans l'ambiance rapidement?",
"As-tu dÃ©jÃ  envoyÃ© des photos compromettantes? Ã‡a s'est bien passÃ©?",
"Quel est ton plus grand tabou que tu n'as jamais brisÃ©?",
"As-tu dÃ©jÃ  simulÃ© pour ne pas blesser quelqu'un?",
"Quelle est la chose la plus importante pour toi dans une relation physique?",
"As-tu dÃ©jÃ  eu une aventure d'un soir? Ã‡a valait le coup?",
"Quel est le compliment le plus chaud qu'on t'ait jamais fait?",
"Quelle est ta vision de la nuit parfaite, avec tous les dÃ©tails?",
"As-tu dÃ©jÃ  utilisÃ© une app de rencontres? Raconte l'expÃ©rience.",
"Quelle est la chose qui t'attire instantanÃ©ment chez quelqu'un?",
"Quel est le moment le plus gÃªnant que tu aies vÃ©cu dans un contexte intime?",
"As-tu dÃ©jÃ  eu des sentiments pour quelqu'un pendant une relation exclusive?",
"Quelle est ton opinion sur les relations ouvertes?",
"Qu'est-ce que tu adores faire mais n'avoues presque jamais?",
"Quelle est la chose la plus courageuse que tu aies faite pour sÃ©duire quelqu'un?",
"DÃ©cris en 3 mots l'expÃ©rience intime idÃ©ale.",
"As-tu dÃ©jÃ  flirtÃ© avec quelqu'un sans t'en rendre compte? Comment tu l'as rÃ©alisÃ©?",
"Quelle est la chose la plus romantique que tu aies faite spontanÃ©ment?",
"As-tu dÃ©jÃ  embrassÃ© quelqu'un de faÃ§on totalement inattendue?",
"Quel est le lieu le plus risquÃ© oÃ¹ tu as fait quelque chose d'osÃ©?",
"Si tu devais choisir une seule qualitÃ© physique chez un partenaire, laquelle?",
"Qu'est-ce que tu ne ferais jamais en couple mais que tu as dÃ©jÃ  envisagÃ©?",
"Quelle est la chose dont tu as besoin dans une relation intime que peu de gens comprennent?",
"Raconte ta premiÃ¨re fois que tu as vraiment ressenti une attirance intense pour quelqu'un.",
"As-tu dÃ©jÃ  jouÃ© Ã  un jeu de sÃ©duction? Comment c'Ã©tait?",
"Quelle est ta faÃ§on prÃ©fÃ©rÃ©e de montrer ton attirance?",
"Quel est le fantasme le plus commun que tu as mais n'assumes pas?",
"Si tu pouvais vivre une nuit dans un film romantique, lequel tu choisirais?",
"Qu'est-ce que tu aimes que ton/ta partenaire fasse et que tu ne lui as jamais dit?",
],
}
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ã‰TAT GLOBAL
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var COLORS=['#ff2d78','#7c3aed','#06d6e0','#fbbf24','#10b981','#f97316','#f472b6','#60a5fa','#a78bfa','#34d399','#fb7185','#38bdf8'];
var AVATARS=['ğŸ˜','ğŸ¤©','ğŸ¥³','ğŸ˜ˆ','ğŸ¦Š','ğŸ±','ğŸ¦','ğŸ‰','ğŸ‘¾','ğŸ¤–','ğŸ­','ğŸŒŸ'];

var myId=sessionStorage.getItem('aov_uid')||Math.random().toString(36).slice(2,11);
sessionStorage.setItem('aov_uid',myId);
var myName='',myColor='',myAvatar='',roomCode='',roomRef=null,gbListener=null,selCats=['classique','coquin'];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// THÃˆME
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var isLight=localStorage.getItem('aov_th')==='light';
function applyTheme(l){
  isLight=l;
  document.documentElement.classList.toggle('light',l);
  document.getElementById('ticon').textContent=l?'â˜€ï¸':'ğŸŒ™';
  document.getElementById('tlbl').textContent=l?'Clair':'Sombre';
  localStorage.setItem('aov_th',l?'light':'dark');
  rebuildOrbs();
}
function toggleTheme(){applyTheme(!isLight);}
applyTheme(isLight);

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CANVAS BACKGROUND
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var cv=document.getElementById('bgc'),cx=cv.getContext('2d'),W,H,orbs=[];
function resizeCv(){W=cv.width=window.innerWidth;H=cv.height=window.innerHeight;}
function mkOrb(){
  var cols=isLight?['#d8156828','#5b21b622','#0369a118']:['#ff2d7820','#7c3aed20','#06d6e015'];
  return{x:Math.random()*W,y:Math.random()*H,r:200+Math.random()*300,vx:(Math.random()-.5)*.35,vy:(Math.random()-.5)*.35,color:cols[Math.floor(Math.random()*cols.length)]};
}
function rebuildOrbs(){orbs=Array.from({length:4},mkOrb);}
resizeCv();window.addEventListener('resize',function(){resizeCv();rebuildOrbs();});rebuildOrbs();
function drawBg(){
  cx.clearRect(0,0,W,H);
  cx.fillStyle=isLight?'#f2f2fa':'#070710';
  cx.fillRect(0,0,W,H);
  orbs.forEach(function(o){
    var g=cx.createRadialGradient(o.x,o.y,0,o.x,o.y,o.r);
    g.addColorStop(0,o.color);g.addColorStop(1,'transparent');
    cx.fillStyle=g;cx.beginPath();cx.arc(o.x,o.y,o.r,0,Math.PI*2);cx.fill();
    o.x+=o.vx;o.y+=o.vy;
    if(o.x<-o.r||o.x>W+o.r)o.vx*=-1;
    if(o.y<-o.r||o.y>H+o.r)o.vy*=-1;
  });
  requestAnimationFrame(drawBg);
}
drawBg();

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// NAVIGATION
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function go(id){
  document.querySelectorAll('.sc').forEach(function(s){s.classList.remove('on');});
  document.getElementById(id).classList.add('on');
  var showBack=['s-create','s-join','s-lobby','s-game'].includes(id);
  document.getElementById('back-btn').classList.toggle('vis',showBack);
}
function goBack(){leaveRoom();go('s-home');}
function goHome(){leaveRoom();go('s-home');}

function toggleCat(el){
  // Remonter au parent .ctile si on a cliquÃ© sur un enfant (span)
  while(el && !el.classList.contains('ctile')) el=el.parentElement;
  if(!el) return;
  var cat=el.dataset.cat;
  var ons=document.querySelectorAll('.ctile.on');
  if(el.classList.contains('on')){
    if(ons.length<=1){toast('âš ï¸ Garde au moins une catÃ©gorie!','er');return;}
    el.classList.remove('on');selCats=selCats.filter(function(c){return c!==cat;});
  }else{
    el.classList.add('on');selCats.push(cat);
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// OUTILS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function genCode(){
  var c='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  return Array.from({length:4},function(){return c[Math.floor(Math.random()*c.length)];}).join('');
}
function shuffle(a){
  var b=[...a];
  for(var i=b.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=b[i];b[i]=b[j];b[j]=t;}
  return b;
}
function buildPool(cats){
  var pool=[];
  cats.forEach(function(cat){
    var q=Q[cat];if(!q)return;
    (q.action||[]).forEach(function(t,i){pool.push({id:cat+'_a_'+i,cat:cat,type:'action',text:t});});
    (q.verite||[]).forEach(function(t,i){pool.push({id:cat+'_v_'+i,cat:cat,type:'verite',text:t});});
  });
  return shuffle(pool);
}

var toastT;
function toast(msg,type,dur){
  dur=dur||2800;
  var t=document.getElementById('toast');
  t.textContent=msg;t.className='up '+(type||'if');
  clearTimeout(toastT);
  toastT=setTimeout(function(){t.classList.remove('up');},dur);
}
function shk(id){
  var el=document.getElementById(id);if(!el)return;
  el.classList.add('shk');setTimeout(function(){el.classList.remove('shk');},400);
}
function copyCode(){
  if(navigator.clipboard){navigator.clipboard.writeText(roomCode).then(function(){toast('ğŸ“‹ Code copiÃ©!','ok');}).catch(function(){toast('Code: '+roomCode,'if');});}
  else{toast('Code: '+roomCode,'if');}
}
function spawnConfetti(){
  var cols=['#ff2d78','#7c3aed','#06d6e0','#fbbf24','#10b981','#f97316'];
  for(var i=0;i<70;i++){
    var el=document.createElement('div');
    var sz=6+Math.random()*10;
    el.style.cssText='position:fixed;left:'+Math.random()*100+'vw;top:-20px;width:'+sz+'px;height:'+sz+'px;background:'+cols[Math.floor(Math.random()*cols.length)]+';border-radius:'+(Math.random()>.5?'50%':'2px')+';animation:confY '+(2+Math.random()*3)+'s '+(Math.random()*1.5)+'s linear forwards;z-index:9999;pointer-events:none;';
    document.body.appendChild(el);
    setTimeout(function(){el.remove();},5500);
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ATTENDRE FIREBASE PRÃŠT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function whenFBReady(fn){
  if(fbReady){fn();}else{setTimeout(function(){whenFBReady(fn);},100);}
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CRÃ‰ER UNE PARTIE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function createGame(){
  var name=document.getElementById('c-name').value.trim();
  if(!name){toast('Entre ton prÃ©nom!','er');shk('c-name');return;}
  if(selCats.length===0){toast('Choisis au moins une catÃ©gorie!','er');return;}
  var rounds=parseInt(document.getElementById('c-rounds').value);
  var code=genCode();
  var idx=Math.floor(Math.random()*COLORS.length);
  myName=name;myColor=COLORS[idx];myAvatar=AVATARS[idx];roomCode=code;
  var pool=buildPool(selCats);
  var gameData={
    code:code,hostId:myId,status:'lobby',
    categories:selCats,totalRounds:rounds,
    currentRound:0,turnPlayerId:null,chosenType:null,currentQuestion:null,
    answers:{},usedIds:[],questionPool:pool.slice(0,300),
    players:{},createdAt:Date.now(),updatedAt:Date.now()
  };
  gameData.players[myId]={id:myId,name:name,color:myColor,avatar:myAvatar,joinedAt:Date.now()};
  whenFBReady(function(){
    db.ref('games/'+code).set(gameData).then(function(){
      attachListener(code);
      go('s-lobby');
      renderLobby(gameData);
      toast('Partie crÃ©Ã©e! Code: '+code,'ok');
    }).catch(function(e){
      toast('Erreur: '+e.message,'er');
      console.error(e);
    });
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// REJOINDRE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function joinGame(){
  var name=document.getElementById('j-name').value.trim();
  var code=document.getElementById('j-code').value.trim().toUpperCase();
  if(!name){toast('Entre ton prÃ©nom!','er');shk('j-name');return;}
  if(code.length!==4){toast('Code Ã  4 caractÃ¨res!','er');shk('j-code');return;}
  whenFBReady(function(){
    db.ref('games/'+code).get().then(function(snap){
      if(!snap.exists()){toast('âŒ Code invalide! VÃ©rifie bien.','er');shk('j-code');return;}
      var game=snap.val();
      if(game.status!=='lobby'){toast('âš ï¸ La partie a dÃ©jÃ  commencÃ©!','er');return;}
      var cnt=Object.keys(game.players||{}).length;
      if(cnt>=8){toast('Partie pleine (max 8 joueurs)!','er');return;}
      var idx=cnt%COLORS.length;
      myName=name;myColor=COLORS[idx];myAvatar=AVATARS[idx];roomCode=code;
      db.ref('games/'+code+'/players/'+myId).set({id:myId,name:name,color:myColor,avatar:myAvatar,joinedAt:Date.now()});
      db.ref('games/'+code+'/updatedAt').set(Date.now());
      attachListener(code);
      go('s-lobby');
      toast('Bienvenue '+name+'! ğŸŠ','ok');
    }).catch(function(e){toast('Erreur de connexion: '+e.message,'er');});
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// LISTENER FIREBASE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function attachListener(code){
  if(gbListener){gbListener();}
  roomRef=db.ref('games/'+code);
  roomRef.on('value',function(snap){
    if(!snap.exists())return;
    var game=snap.val();
    var cur=document.querySelector('.sc.on');
    var curId=cur?cur.id:'';
    if(game.status==='lobby'){
      renderLobby(game);
    }else if(['choosing','answering','reveal'].includes(game.status)){
      if(curId==='s-lobby')go('s-game');
      renderGame(game);
    }else if(game.status==='end'){
      renderEnd(game);
    }
  });
  gbListener=function(){roomRef.off('value');};
}
function leaveRoom(){
  if(gbListener){gbListener();gbListener=null;}
  roomRef=null;roomCode='';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// LOBBY
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderLobby(game){
  document.getElementById('l-code').textContent=game.code;
  var players=Object.values(game.players||{}).sort(function(a,b){return a.joinedAt-b.joinedAt;});
  var listEl=document.getElementById('l-players');
  listEl.innerHTML='';
  players.forEach(function(p){
    var isHost=p.id===game.hostId,isMe=p.id===myId;
    var div=document.createElement('div');
    div.className='prow'+(isMe?' me':'');
    div.innerHTML='<div class="pav" style="background:'+p.color+'22;color:'+p.color+'">'+p.avatar+'</div>'
      +'<div class="pnm">'+p.name+(isMe?' <span style="color:var(--mu);font-weight:400;font-size:11px">(moi)</span>':'')+'</div>'
      +(isHost?'<span class="pbdg bhost">ğŸ‘‘ HÃ´te</span>':(isMe?'<span class="pbdg bme">Moi</span>':'<span class="pbdg bread">âœ“</span>'));
    listEl.appendChild(div);
  });
  if(players.length<8){var e=document.createElement('div');e.className='empty-slot';e.innerHTML='<span style="font-size:17px">â•</span> En attente de joueurs...';listEl.appendChild(e);}
  var catN={classique:'ğŸ˜‚ Classique',coquin:'ğŸ˜ Coquin',couple:'ğŸ’‘ Couple',hot:'ğŸ”¥ Hot'};
  document.getElementById('l-settings').innerHTML='<strong>'+game.totalRounds+' rounds</strong> &nbsp;â€¢&nbsp; '+(game.categories||[]).map(function(c){return catN[c]||c;}).join(' &nbsp;â€¢&nbsp; ');
  var cnt=players.length;
  document.getElementById('l-status').textContent=cnt<2?cnt+'/2 joueurs minimum':cnt+' joueur'+(cnt>1?'s':'')+' connectÃ©'+(cnt>1?'s':'');
  var isHost=game.hostId===myId,canStart=cnt>=2;
  document.getElementById('l-start').style.display=(isHost&&canStart)?'flex':'none';
  var hint=document.getElementById('l-hint');
  if(isHost&&!canStart){hint.style.display='block';hint.textContent='Il faut au moins 2 joueurs!';}
  else if(!isHost){hint.style.display='block';hint.textContent=canStart?"L'hÃ´te va lancer...":'En attente d\'un autre joueur...';}
  else{hint.style.display='none';}
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// LANCER
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startGame(){
  whenFBReady(function(){
    db.ref('games/'+roomCode).get().then(function(snap){
      var game=snap.val();if(!game)return;
      var ids=Object.keys(game.players).sort(function(a,b){return game.players[a].joinedAt-game.players[b].joinedAt;});
      if(ids.length<2){toast('Il faut au moins 2 joueurs!','er');return;}
      db.ref('games/'+roomCode).update({status:'choosing',currentRound:1,turnPlayerId:ids[0],chosenType:null,currentQuestion:null,answers:{},updatedAt:Date.now()});
    });
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RENDU JEU
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderGame(game){
  var isMyTurn=game.turnPlayerId===myId;
  var tp=game.players&&game.players[game.turnPlayerId];
  var isHost=game.hostId===myId;
  document.getElementById('g-turn').textContent=isMyTurn?'TON TOUR!':(tp?tp.name:'?');
  document.getElementById('g-round').textContent='Round '+game.currentRound+'/'+game.totalRounds;
  var pct=((game.currentRound-1)/game.totalRounds)*100;
  document.getElementById('g-prog').style.width=pct+'%';
  // cacher tout
  ['ph-choose','ph-ans','ph-rev'].forEach(function(id){document.getElementById(id).style.display='none';});

  if(game.status==='choosing'){
    document.getElementById('ph-choose').style.display='block';
    var btns=document.getElementById('ch-btns'),wait=document.getElementById('ch-wait'),who=document.getElementById('ch-who');
    if(isMyTurn){who.textContent="C'EST TON TOUR!";btns.style.display='grid';wait.style.display='none';}
    else{who.textContent=(tp?tp.name:'?')+' CHOISIT...';btns.style.display='none';wait.style.display='block';}

  }else if(game.status==='answering'){
    document.getElementById('ph-ans').style.display='block';
    var q=game.currentQuestion;if(!q)return;
    document.getElementById('a-cat').textContent=q.cat;
    var tag=document.getElementById('a-tag'),card=document.getElementById('ph-ans');
    card.className='qcard '+(q.type==='action'?'ta_':'tv')+(q.cat==='hot'?' hot':'');
    tag.className='qtag '+(q.type==='action'?'tga':'tgv');
    tag.innerHTML=q.type==='action'?'ğŸ’ª ACTION':'ğŸ’¬ VÃ‰RITÃ‰';
    document.getElementById('a-q').textContent=q.text;
    var allP=Object.keys(game.players||{});
    var myDone=!!(game.answers&&game.answers[myId]);
    var mine=document.getElementById('a-mine'),waitDiv=document.getElementById('a-wait'),wtxt=document.getElementById('a-waittxt');
    if(myDone){
      mine.style.display='none';waitDiv.style.display='block';
      var waiting=allP.filter(function(pid){return !(game.answers&&game.answers[pid]);}).map(function(pid){return game.players[pid]?game.players[pid].name:'?';});
      wtxt.textContent=waiting.length?'En attente de: '+waiting.join(', '):'Tous ont rÃ©pondu!';
    }else{
      mine.style.display='block';waitDiv.style.display='none';
      document.getElementById('a-inp').value='';
    }

  }else if(game.status==='reveal'){
    document.getElementById('ph-ans').style.display='block';
    document.getElementById('ph-rev').style.display='block';
    var q2=game.currentQuestion;
    if(q2){
      document.getElementById('a-cat').textContent=q2.cat;
      var tag2=document.getElementById('a-tag'),c2=document.getElementById('ph-ans');
      c2.className='qcard '+(q2.type==='action'?'ta_':'tv')+(q2.cat==='hot'?' hot':'');
      tag2.className='qtag '+(q2.type==='action'?'tga':'tgv');
      tag2.innerHTML=q2.type==='action'?'ğŸ’ª ACTION':'ğŸ’¬ VÃ‰RITÃ‰';
      document.getElementById('a-q').textContent=q2.text;
      document.getElementById('r-recap').textContent='"'+q2.text+'"';
    }
    document.getElementById('a-mine').style.display='none';
    document.getElementById('a-wait').style.display='none';
    var rc=document.getElementById('r-cards');rc.innerHTML='';
    Object.entries(game.answers||{}).forEach(function(entry){
      var pid=entry[0],ans=entry[1];
      var p=game.players&&game.players[pid];if(!p)return;
      var div=document.createElement('div');div.className='rans';div.style.borderLeftColor=p.color;
      div.innerHTML='<div class="rwho" style="color:'+p.color+'">'+p.avatar+' '+p.name+(pid===myId?' <span style="color:var(--mu);font-weight:400;font-size:11px">(moi)</span>':'')+'</div>'
        +'<div class="'+(ans?'rtxt':'remp')+'">'+( ans||'Pas de rÃ©ponse')+'</div>';
      rc.appendChild(div);
    });
    document.getElementById('r-next').style.display=isHost?'flex':'none';
    document.getElementById('r-wait').style.display=isHost?'none':'block';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ACTIONS JOUEUR
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function pickType(type){
  whenFBReady(function(){
    db.ref('games/'+roomCode).get().then(function(snap){
      var game=snap.val();
      if(!game||game.turnPlayerId!==myId)return;
      var used=game.usedIds||[];
      var pool=game.questionPool||[];
      var avail=pool.filter(function(q){return q.type===type&&!used.includes(q.id);});
      var candidates=avail.length>0?avail:pool.filter(function(q){return q.type===type;});
      if(candidates.length===0){toast('Plus de questions de ce type!','er');return;}
      var q=candidates[Math.floor(Math.random()*candidates.length)];
      var newUsed=used.concat([q.id]).slice(-200);
      db.ref('games/'+roomCode).update({status:'answering',chosenType:type,currentQuestion:q,answers:{},usedIds:newUsed,updatedAt:Date.now()});
    });
  });
}

function submitAns(){
  var answer=document.getElementById('a-inp').value.trim();
  if(!answer){toast('Ã‰cris une rÃ©ponse!','er');shk('a-inp');return;}
  whenFBReady(function(){
    db.ref('games/'+roomCode).get().then(function(snap){
      var game=snap.val();if(!game)return;
      var updates={};
      updates['answers/'+myId]=answer;
      updates['updatedAt']=Date.now();
      var newAnswers=Object.assign({},game.answers||{});
      newAnswers[myId]=answer;
      var allP=Object.keys(game.players||{});
      var allDone=allP.every(function(pid){return newAnswers[pid];});
      if(allDone)updates['status']='reveal';
      db.ref('games/'+roomCode).update(updates);
    });
  });
}

function nextRound(){
  whenFBReady(function(){
    db.ref('games/'+roomCode).get().then(function(snap){
      var game=snap.val();
      if(!game||game.hostId!==myId)return;
      if(game.currentRound>=game.totalRounds){
        db.ref('games/'+roomCode).update({status:'end',updatedAt:Date.now()});return;
      }
      var ids=Object.keys(game.players).sort(function(a,b){return game.players[a].joinedAt-game.players[b].joinedAt;});
      var curIdx=ids.indexOf(game.turnPlayerId);
      var nextId=ids[(curIdx+1)%ids.length];
      db.ref('games/'+roomCode).update({status:'choosing',currentRound:game.currentRound+1,turnPlayerId:nextId,chosenType:null,currentQuestion:null,answers:{},updatedAt:Date.now()});
    });
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FIN DE PARTIE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderEnd(game){
  go('s-end');
  spawnConfetti();
  var players=Object.values(game.players||{}).sort(function(a,b){return(b.score||0)-(a.score||0);});
  document.getElementById('e-sub').textContent=game.totalRounds+' rounds terminÃ©s â€” GG Ã  tous! ğŸ‰';
  var medals=['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'];
  var pod=document.getElementById('e-pod');pod.innerHTML='';
  players.forEach(function(p,i){
    var div=document.createElement('div');div.className='podrow';
    div.innerHTML='<div class="podrank">'+(medals[i]||'#'+(i+1))+'</div>'
      +'<div class="pav" style="background:'+p.color+'22;color:'+p.color+'">'+p.avatar+'</div>'
      +'<div style="font-weight:700;flex:1">'+p.name+(p.id===myId?' (moi)':'')+'</div>'
      +'<div class="xs muted mono">'+game.totalRounds+' rounds</div>';
    pod.appendChild(div);
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TOUS LES EVENT LISTENERS â€” propre, sans onclick inline
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', function(){

  // Boutons fixes (toujours prÃ©sents)
  document.getElementById('back-btn').addEventListener('click', goBack);
  document.getElementById('theme-btn').addEventListener('click', toggleTheme);

  // Home
  document.getElementById('btn-go-create').addEventListener('click', function(){ go('s-create'); });
  document.getElementById('btn-go-join').addEventListener('click', function(){ go('s-join'); });

  // Create
  document.getElementById('btn-create').addEventListener('click', createGame);
  document.getElementById('btn-create-back').addEventListener('click', function(){ go('s-home'); });

  // CatÃ©gories â€” event delegation sur le parent cat-grid
  var catGrid = document.querySelector('.cat-grid');
  if(catGrid){
    catGrid.addEventListener('click', function(e){
      // Remonter jusqu'au ctile
      var tile = e.target;
      while(tile && tile !== catGrid && !tile.classList.contains('ctile')){
        tile = tile.parentElement;
      }
      if(!tile || !tile.classList.contains('ctile')) return;
      toggleCat(tile);
    });
  }

  // Join
  document.getElementById('btn-join').addEventListener('click', joinGame);
  document.getElementById('btn-join-back').addEventListener('click', function(){ go('s-home'); });

  // Code input: forcer majuscules
  var jcode = document.getElementById('j-code');
  jcode.addEventListener('input', function(){
    this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
  });
  jcode.addEventListener('keydown', function(e){
    if(e.key === 'Enter') joinGame();
  });

  // Lobby
  document.getElementById('l-start').addEventListener('click', startGame);
  document.getElementById('btn-copy').addEventListener('click', copyCode);

  // Game â€” Action/VÃ©ritÃ©
  document.getElementById('btn-action').addEventListener('click', function(){ pickType('action'); });
  document.getElementById('btn-verite').addEventListener('click', function(){ pickType('verite'); });

  // RÃ©pondre
  document.getElementById('btn-submit').addEventListener('click', submitAns);

  // Next round
  document.getElementById('r-next').addEventListener('click', nextRound);

  // End screen
  document.getElementById('btn-replay').addEventListener('click', goHome);
  document.getElementById('btn-home-end').addEventListener('click', goHome);
});

</script>

</body>
</html>